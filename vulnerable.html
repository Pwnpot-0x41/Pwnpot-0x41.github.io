<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Vulnerable (simulated)</title>
  <script>
    // Simulated unsafe handling of opener.location and hashchange
    function showOpenerHref() {
      try {
        // unsafe: directly injects opener.location into DOM
        // (simulating code like document.write('<iframe src="' + opener.location.href + '"></iframe>'))
        const out = "<div>opener.href: <span id='oh'>" + opener.location + "</span></div>";
        document.getElementById('content').innerHTML = out;
      } catch (e) {
        // opener may be undefined or not same-origin
        document.getElementById('content').innerText = 'Could not read opener: ' + e;
      }
    }

    // Example of unsafe hashchange handler that uses location.hash without sanitizing
    window.addEventListener('hashchange', function() {
      // Intentionally unsafe for PoC: inserts raw HTML derived from hash
      const raw = location.hash.slice(1); // remove leading '#'
      // place payload into the DOM unsafely:
      document.getElementById('hashOutput').innerHTML = "Hash content (unsafe): " + raw;
    });

    window.onload = function() {
      showOpenerHref();
      // show current hash if any:
      if (location.hash) {
        document.getElementById('hashOutput').innerHTML = "Hash content (on load): " + location.hash.slice(1);
      }
    };
  </script>
</head>
<body>
  <h1>Vulnerable Page (local test)</h1>
  <div id="content">opener info will appear here</div>
  <div id="hashOutput" style="margin-top:1em;color:darkred;">hash output appears here</div>
  <p>Note: This page intentionally contains unsafe DOM usage for demonstration only.</p>
</body>
</html>
